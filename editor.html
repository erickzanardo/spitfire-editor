<!DOCTYPE html>
<html>
  <head>
    <title>Spitfire Editor</title>
      <link rel="stylesheet" href="components/widgets/style.css">
      <link rel="stylesheet" href="core/libs/bootstap/css/bootstrap.min.css">
      <script type="text/javascript" src="core/libs/jquery-2.1.3.min.js"></script>
      <script type="text/javascript" src="core/libs/bootstap/js/bootstrap.min.js"></script>
      <script type="text/javascript" src="core/libs/ace/src-min-noconflict/ace.js"></script>
      <script type="text/javascript" src="core/libs/ace/src-min-noconflict/ext-modelist.js"></script>
      <script type="text/javascript" src="core/spitfire-manager.js"></script>
      <script type="text/javascript" src="core/libs/mousetrap.min.js"></script>
      <script type="text/javascript">
          $(document).ready(function() {
              var spitfireManager = new SpitfireManager(Mousetrap);

              var keyManager = spitfireManager.keyManager();
              var helperKeys = keyManager.helperKeys;
              
              var keydownkeys = [helperKeys.BACKSPACE_KEY,
                                 helperKeys.CONTROL_KEY,
                                 helperKeys.LEFT_KEY,
                                 helperKeys.RIGHT_KEY];

              var keyhandler = function(e) {
                  var key = e.which;

                  if ((e.type == 'keypress') || (e.type == 'keydown' && keydownkeys.indexOf(key) != -1)) {
                      var listeners = spitfireManager.inputListeners();
                      for (var i = 0 ; i < listeners.length ; i++) {
                          var listener = listeners[i];
                          if (!listener(e)) {
                              return false;
                          }
                      }
                  }
              };
              
              $(document).bind('keydown.terminal', keyhandler);
              $(document).bind('keypress.terminal', keyhandler);
              
              var gui = require('nw.gui');
              var se = require('./spitfire-editor.js');
              se.init(gui, $('#SpitfireContainer'), spitfireManager);
          });
      </script>
  </head>
  <body>
      <div id="SpitfireContainer">Loading...</div>
  </body>
</html>
